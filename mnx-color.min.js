!function(a){"use strict";function c(a){var b=a[0]/255,c=a[1]/255,d=a[2]/255,e=Math.max(b,c,d),f=Math.min(b,c,d),g=e-f,h=0,i=0;return e!==f&&(e===b&&(h=(c-d)/g+(c<d?6:0)),e===c&&(h=(d-b)/g+2),e===d&&(h=(b-c)/g+4),h/=6,i=g/e),[h,i,e]}function d(a){var b=6*a[0],c=a[1],d=a[2],e=Math.floor(b),f=b-e,h=d*(1-c),i=d*(1-c*f),j=d*(1-c*(1-f)),k=e%6,l=[d,i,h,h,j,d][k],m=[j,d,d,i,h,h][k],n=[h,h,j,d,d,i][k];return[g(255*l),g(255*m),g(255*n)]}function e(a,b,c){return c=c?c/100:0,b=b?b/100:0,b*=c<.5?c:1-c,[a/360,b?2*b/(c+b):0,c+b]}function f(a,b){return+a>b?b:+a<0?0:+a}function g(a){return Math.round(+a)}function h(c){return a.element("<div class="+b+c+" name="+c+"></div>")}function i(a,b){for(var c=0,d=0;a;)c+=a.offsetTop||0,d+=a.offsetLeft||0,b&&(c+=a.clientTop||0,d+=a.clientLeft||0),a=a.offsetParent;return{top:c,left:d}}function j(a){return{"background-image":"linear-gradient(90deg,rgba("+a+",0),rgb("+a+")),repeating-linear-gradient(45deg,#fff,#fff 3%,#ddd 3%,#ddd 6%)"}}function k(b){return{restrict:"A",require:"ngModel",link:function(l,m,n,o){function F(a,b){"alpha"===D.name?(z=a/D.width,w.css({left:a+"px"})):("lch"===D.name?(y[B]=a/D.width,y[C]=(D.height-b)/D.height,u.css({top:b+"px",left:a+"px"}),t.css({"background-color":"rgb("+d([y[0],y[1],1])+")"})):"rch"===D.name&&(y[A]=b/D.height,v.css({top:b+"px"}),s.css({"background-color":"rgb("+d([y[0],1,1])+")"})),x=d(y),r.css(j(x))),z<1?o.$setViewValue("rgba("+x+","+g(100*z)/100+")"):o.$setViewValue("#"+("00000"+((x[0]<<16)+(x[1]<<8)+x[2]).toString(16)).substr(-6)),o.$render()}function G(){y=c(x),u.css({top:g(s[0].clientHeight-1-y[C]*(s[0].clientHeight-1))+"px",left:g(y[B]*(s[0].clientWidth-1))+"px"}),v.css({top:g(y[A]*(t[0].clientHeight-1))+"px",left:0}),w.css({top:0,left:g(z*(r[0].clientWidth-1))+"px"}),t.css({"background-color":"rgb("+d([y[0],y[1],1])+")"}),s.css({"background-color":"rgb("+d([y[0],1,1])+")"}),r.css(j(x))}function H(a,b){var c;if(a&&a!==b){if(c=/^#([\da-f]{3}(?:[\da-f]{3})?)$/i.exec(a))c=parseInt(c[1][3]?c[1]:c[1].replace(/(.)/g,"$1$1"),16),x=[c>>16&255,c>>8&255,255&c],z=1;else if(c=/^(rgb|hsl)(a?)\((\d+)(%?) *, *(\d+)(%?) *, *(\d+)(%?)(?: *, *(\d*\.?\d+))?\)$/.exec(a)){if(c[2]?!c[9]:c[9])return;if("hsl"===c[1]&&!c[4]&&c[6]&&c[8])x=d(e(f(c[3],360),f(c[5],100),f(c[7],100)));else{if("rgb"!==c[1]||c[4]!==c[6]||c[6]!==c[8])return;c[4]&&(c[3]=g(2.55*c[3]),c[5]=g(2.55*c[5]),c[7]=g(2.55*c[7])),x=[f(c[3],255),f(c[5],255),f(c[7],255)]}z=f(c[9]||1,1)}else if("transparent"===a)x=[0,0,0],z=0;else{if(!(c=/^[a-z]{3,}$/i.exec(a)))return;if(r.css({color:"rgba(0,0,0,0)"}),r.css({color:c[0]}),c=window.getComputedStyle(r[0]).color.match(/(\d)+/g),"0,0,0,0"===c.join())return;x=[+c[0],+c[1],+c[2]],z=1}G()}}function I(){E=l.$watch(n.ngModel,H)}function J(a){var b=f(a.pageX-D.left,D.width),c=f(a.pageY-D.top,D.height);a.stopPropagation(),a.preventDefault(),F(b,c)}function K(a){var c=this,d=i(c,!0);D={name:c.getAttribute("name"),width:c.clientWidth-1,height:c.clientHeight-1,top:d.top,left:d.left},E(),J(a),b.on("mousemove",J).on("mouseup",function a(){b.off("mousemove",J).off("mouseup",a),I()})}var D,E,p=n.mode||"h",q=h("container"),r=h("alpha"),s=h("lch"),t=h("rch"),u=h("lcur"),v=h("rcur"),w=h("acur"),x=[0,0,0],y=[0,0,0],z=1,A=0,B=1,C=2;"v"===p?(A=2,B=0,C=1,s.css({"background-image":"linear-gradient(0deg,#fff,rgba(255,255,255,0)),linear-gradient(90deg,#f00,#ff0,#0f0,#0ff,#00f,#f0f,#f00)"}),t.css({"background-image":"linear-gradient(#000,rgba(0,0,0,0))"})):(s.css({"background-image":"linear-gradient(0deg,#000,rgba(0,0,0,0)),linear-gradient(90deg,#fff,rgba(255,255,255,0))"}),t.css({"background-image":"linear-gradient(#f00,#ff0,#0f0,#0ff,#00f,#f0f,#f00)"})),q.append(s.append(u)).append(t.append(v)).append(r.append(w)),m.on("focus",function(){var c=i(m[0]);q.css({top:c.top+m[0].offsetHeight+"px",left:c.left+"px"}),a.element(document.body).append(q),s.on("mousedown",K),t.on("mousedown",K),r.on("mousedown",K),H(o.$viewValue),G(),I(),m.on("blur",function a(){m.off("blur",a),E(),q.remove()})})}}}var b="mnx-color-";k.$inject=["$document"],a.module("mnxColor",[]).directive("mnxColor",k)}(window.angular);