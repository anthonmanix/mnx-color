!function(a){"use strict";function d(a){var e,g,h,i,b=["<svg width=100% height=100% xmlns=http://www.w3.org/2000/svg>"],d=["<defs>"],f=a.length;for(e=0;f>e;e+=1){for(c+=1,d.push("<linearGradient id=g",c,a[e].dir?" x2=0 y2=1":"",">"),g=a[e].stops,i=g.length-1,h=0;i>=h;h+=1)d.push("<stop offset=",h/i," stop-color=#",g[h].substr(0,3)," stop-opacity=",g[h][3]||1,"/>");d.push("</linearGradient>"),b.push("<rect width=100% height=100% fill=url(#g",c,")/>")}return d.push("</defs>"),b.splice(1,0,d.join("")),d.push("</svg>"),b.join("")}function e(a){var b=a[0]/255,c=a[1]/255,d=a[2]/255,e=Math.max(b,c,d),f=Math.min(b,c,d),g=e-f,h=0,i=0;if(e!==f){switch(e){case b:h=(c-d)/g+(d>c?6:0);break;case c:h=(d-b)/g+2;break;case d:h=(b-c)/g+4}h/=6,i=g/e}return[h,i,e]}function f(a){var b=6*a[0],c=a[1],d=a[2],e=Math.floor(b),f=b-e,g=d*(1-c),h=d*(1-c*f),i=d*(1-c*(1-f)),j=e%6,k=[d,h,g,g,i,d][j],l=[i,d,d,h,g,g][j],m=[g,g,i,d,d,h][j];return[Math.round(255*k),Math.round(255*l),Math.round(255*m)]}function g(c){return{restrict:"A",require:"ngModel",link:function(g,h,i,j){function x(a,b){"alpha"===v.name?(u=a/v.width,r.css({left:a+"px"})):("lch"===v.name?(t[1]=a/v.width,t[2]=(v.height-b)/v.height,p.css({top:b+"px",left:a+"px"})):"rch"===v.name&&(t[0]=b/v.height,q.css({top:b+"px"}),l.css({"background-color":"rgb("+f([t[0],1,1])+")"})),s=f(t),o.attr("stop-color","rgb("+s+")")),1!==u?j.$setViewValue("rgba("+s+","+Math.round(100*u)/100+")"):j.$setViewValue(["#",("0"+s[0].toString(16)).substr(-2),("0"+s[1].toString(16)).substr(-2),("0"+s[2].toString(16)).substr(-2)].join("")),j.$render()}function y(){t=e(s),p.css({top:Math.round(l[0].clientHeight-1-t[2]*(l[0].clientHeight-1))+"px",left:Math.round(t[1]*(l[0].clientWidth-1))+"px"}),q.css({top:Math.round(t[0]*(m[0].clientHeight-1))+"px",left:0}),r.css({top:0,left:Math.round(u*(n[0].clientWidth-1))+"px"}),l.css({"background-color":"rgb("+f([t[0],1,1])+")"}),o.attr("stop-color","rgb("+s+")")}function z(a,b){if(a!==b){var c=[];if(c=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a))s=[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)];else if(c=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(a))s=[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)];else if(c=/^rgba?\((\d+),\s?(\d+),\s?(\d+),?\s?(\d*\.?\d+)?\)$/.exec(a))s=[+c[1],+c[2],+c[3]];else{if(!a||!(c=/^[a-z]{3,}$/i.exec(a)))return;if(n.css({color:"rgba("+s+","+Math.round(100*u)/100+")"}),n.css({color:c[0]}),c=window.getComputedStyle(n[0]).color.match(/(\d?\.?\d+)+/g)||[0,0,0,"0"],c.join()===s.join()+(1!==u?","+u:""))return;c.unshift(0),s=[+c[1],+c[2],+c[3]]}u=+(c[4]||1),y()}}function A(){w=g.$watch(i.ngModel,z)}function B(a){var b=Math.min(v.width,Math.max(0,a.pageX-v.left)),c=Math.min(v.height,Math.max(0,a.pageY-v.top));a.stopPropagation(),a.preventDefault(),x(b,c)}function C(a){var b=this,d=b.offsetParent;v={name:b.getAttribute("name"),width:b.clientWidth-1,height:b.clientHeight-1,top:d.offsetTop+d.clientTop+b.offsetTop+b.clientTop,left:d.offsetLeft+d.clientLeft+b.offsetLeft+b.clientLeft},w(),B(a),c.on("mousemove",B).on("mouseup",function e(){c.off("mousemove",B).off("mouseup",e),A()})}var v,w,k=a.element('<div class="'+b+'container"></div>'),l=a.element(['<div name="lch" class="'+b+'lch">',d([{stops:["fff","fff0"]},{stops:["0000","000"],dir:1}]),"</div>"].join("")),m=a.element(['<div name="rch" class="'+b+'rch">',d([{stops:["f00","ff0","0f0","0ff","00f","f0f","f00"],dir:1}]),"</div>"].join("")),n=a.element(['<div name="alpha" class="'+b+'alpha">',d([{stops:["0000","000"]}]),"</div>"].join("")),o=n.find("stop"),p=a.element('<div class="'+b+'lcur"></div>'),q=a.element('<div class="'+b+'rcur"></div>'),r=a.element('<div class="'+b+'acur"></div>'),s=[0,0,0],t=[0,0,0],u=1;k.append(l.append(p)).append(m.append(q)).append(n.append(r)),h.on("focus",function(){k.css({top:h[0].offsetTop+h[0].offsetHeight+"px",left:h[0].offsetLeft+"px"}),h.after(k),l.on("mousedown",C),m.on("mousedown",C),n.on("mousedown",C),y(),A(),h.on("blur",function a(){h.off("blur",a),w(),k.remove()})})}}}var b="mnx-color-",c=0;g.$inject=["$document"],a.module("mnxColor",[]).directive("mnxColor",g)}(window.angular);
